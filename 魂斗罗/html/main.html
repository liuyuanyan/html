<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="../js/Background.js"></script>
    <script type="text/javascript" src="../js/Hero.js"></script>
    <script type="text/javascript" src="../js/Keyboard.js"></script>
    <script type="text/javascript" src="../js/Shot.js"></script>
    <script type="text/javascript" src="../js/Enemy.js"></script>
    <script type="text/javascript" src="../js/Hit.js"></script>
    <title>小游戏——魂斗罗</title>
    <script>
     //定义全局变量
        var g_canvas;
        //定义全局上下文
        var g_context;

        var g_background;

        var bgMusic;

        var g_hero;
        var  g_shotArray=new Array();
        var  g_enemyArray=new Array();
        //定义全局速度
        var g_speed=5;
        var count=0;
        var g_score=0;
     var over;
        window.onload=function(){
            over=document.getElementById("over");
            //  播放背景音乐
            bgMusic=new Audio();
            bgMusic.src="../source/bgm.wav";
            bgMusic.play();
            //初始化当前画布
            g_canvas=document.getElementById("can");
            //初始化上下文
            g_context=g_canvas.getContext("2d");
            //初始化背景图
            g_background=new Background(0,0,"bgimg");
             //初始化英雄     位置
            g_hero=new Hero(80,90,'hero5','hero6');
            //产生敌机


            g_shot=new Shot();
            //监听键盘
            document.addEventListener("keyup",keyUp,true);
            document.addEventListener("keydown",keyDown,true);
            //开启定时器
            setInterval(function(){
                //绘制背景
                g_background.show();
                //绘制英雄
                g_hero.show();
                //重绘所有子弹
                for(var i=0;i<g_shotArray.length;i++){

                    if(g_shotArray[i]){
                        g_shotArray[i].show();
                        g_shotArray[i].removeShot();
                    }

                }
                //重绘敌机
                for(var i=0;i<g_enemyArray.length;i++){
                    g_enemyArray[i].show();
                    //当敌机超出屏幕移除
                    g_enemyArray[i].removeEnemy();
                }

                //产生敌机
                count++;
                if(count%50==0){

                    var  ramdon=parseInt(Math.random()*100000%8+1);

                    makeEnemyWithType(ramdon);
                }


            },60);

        }
     //如果图片是打开的则换成关闭的
        function changeImg(cell){
           if(cell.src.indexOf("open")>0){
               cell.src="../image/close.png";
               bgMusic.pause();
           }else{
               cell.src="../image/open.png";
               bgMusic.play();
           }
        }
    </script>
    <style>
        .hide{
            display: none;
        }
        .container{
            position: relative;
            width: 500px;
            height: 270px;
        }
        .container .imgg{
            position: absolute;;
            left: 470px;
            top: 10px;
        }
        .score{

            position: absolute;
            left: 10px;
            top: 10px;
            color: white;
            font-size: 18px;
            font-weight: bold;
        }
        .over{
            display: none;
            position: absolute;
            left: 160px;
            top: 80px;
        }
    </style>
</head>
<body>

<div class="container">
    <canvas id="can" width="500px" height="270px"></canvas>

    <img src="../image/open.png" width="30px" height="30px" onclick="changeImg(this)" title="声音开关" class="imgg">
    <div id="score" class="score">score：0</div>
    <img src="../image/over.png" id="over" class="over">
</div>
<img src="../image/123.png" id="bgimg" class="hide">
<img src="../image/hero5.png" id="hero5" class="hide">
<img src="../image/hero6.png" id="hero6" class="hide">
<img src="../image/hero3.png" id="hero3" class="hide">
<img src="../image/d1.png" id="d1" class="hide">
<img src="../image/d2.png" id="d2" class="hide">
<img src="../image/d3.png" id="d3" class="hide">
<img src="../image/shot.jpg" id="shot" class="hide">

</body>
</html>